<Project Sdk="Microsoft.NET.Sdk">
    <PropertyGroup>
        <TargetFramework>net6.0</TargetFramework>
        <ImplicitUsings>disable</ImplicitUsings>
        <Configurations>Debug;Release</Configurations>
        <Optimize>false</Optimize>
        <DebugType>embedded</DebugType>
        <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
        <LangVersion>preview</LangVersion>
    </PropertyGroup>

    <PropertyGroup>
        <!--BloonsTD6 property gets automatically set correctly when this file is generated by the Mod Helper on startup-->
        <BloonsTD6 Condition="'$(BloonsTD6)' == ''">C:\Program Files (x86)\Steam\steamapps\common\BloonsTD6</BloonsTD6>
        <Il2CppAssemblies>$(BloonsTD6)\MelonLoader\Il2CppAssemblies</Il2CppAssemblies>
        <ManagedFolder>$(BloonsTD6)\MelonLoader\net6</ManagedFolder>
        <OutputFolder Condition="'$(OutputFolder)' == ''">Plugins</OutputFolder>
    </PropertyGroup>

    <ItemGroup>
        <Compile Include="..\BloonsTD6 Mod Helper\Api\Data\ModHelperData.Shared.cs"/>
        <Compile Include="..\BloonsTD6 Mod Helper\Extensions\SystemExtensions\HttpClientExtensions.cs"/>
        <Compile Include="..\BloonsTD6 Mod Helper\Api\ModHelperHttp.cs"/>
    </ItemGroup>
    
    <ItemGroup>
        <Reference Include="$(BloonsTD6)\MelonLoader\net6\MelonLoader.dll" Private="false"/>
        <Reference Include="$(BloonsTD6)\MelonLoader\net6\0Harmony.dll" Private="false"/>
        <Reference Include="$(BloonsTD6)\MelonLoader\net6\AssetRipper.VersionUtilities.dll" Private="false"/>
        <Reference Include="$(ManagedFolder)\Newtonsoft.Json.dll" Private="false"/>
        <Reference Include="$(Il2CppAssemblies)\UnityEngine.CoreModule.dll" Private="false"/>
    </ItemGroup>
    
    <ItemGroup>
      <PackageReference Include="TinyDialogsNet" Version="2.0.0" />
    </ItemGroup>

    <Target Name="MoveDllToPlugins" AfterTargets="Build" Condition="Exists('$(TargetDir)$(TargetName).dll')">
        <Message Text="Copying $(ProjectName).dll to $(OutputFolder) Folder..." Importance="High"/>

        <Copy SourceFiles="$(TargetDir)$(TargetName).dll"
              DestinationFiles="$(BloonsTD6)\$(OutputFolder)\$(ProjectName).dll"/>
    </Target>

</Project>
